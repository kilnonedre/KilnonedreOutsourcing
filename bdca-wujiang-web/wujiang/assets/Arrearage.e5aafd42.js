import{C as D}from"./CommonHeader.a228caf3.js";import{d as S}from"./api.22883e35.js";import{t as U}from"./table2excel.fee53b5f.js";import{_ as j,a as E,r as c,k as F,o as r,c as p,d as h,b as o,w as d,T as P,m as V,i as m,F as _,h as f,f as y,D as J,p as q,q as G,t as w}from"./index.22501be6.js";import{_ as K}from"./icon_screen.7fe101fd.js";const b={dw1:{label:"\u4E2D\u5FC3\u53CA\u5E7F\u7535\u7AD9",width:"210"},gridName:{label:"\u6240\u5C5E\u7F51\u683C",width:"200"},custCode:{label:"\u5BA2\u6237\u8BC1\u53F7",width:"180"},custName:{label:"\u5BA2\u6237\u59D3\u540D",width:"200"},custType:{label:"\u5BA2\u6237\u7C7B\u578B",width:"120"},custTag:{label:"\u5BA2\u6237\u6807\u8BC6",width:"120"},regionId:{label:"\u533A\u57DFID",width:"220"},regionName1:{label:"\u9547/\u8857\u9053",width:"180"},regionName2:{label:"\u6751/\u793E\u533A",width:"180"},regionName3:{label:"\u5C0F\u533A",width:"180"},loudong:{label:"\u697C\u680B",width:"180"},doorDesc:{label:"\u95E8\u724C",width:"180"},mobile1:{label:"\u79FB\u52A8\u7535\u8BDD1",width:"210"},mobile2:{label:"\u79FB\u52A8\u7535\u8BDD2",width:"210"},phone1:{label:"\u7535\u8BDD1",width:"210"},phone2:{label:"\u7535\u8BDD2",width:"210"},zt:{label:"\u72B6\u6001",width:"80"},restBalance:{label:"\u5F53\u524D\u4F59\u989D(\u5143)",width:"140"},payType:{label:"\u652F\u4ED8\u65B9\u5F0F",width:"120"}},M={components:{CommonHeader:D},data(){return{loading:!0,tableData:[],allHeader:b,tableHeader:[],showHeader:[],downLoading:!1,content:"",restBalance:"",station:"",gridName:"",station_grid:[],stationOptions:[],client:"",clientOptions:[{label:"\u516C\u4F17\u5BA2\u6237",value:"\u516C\u4F17\u5BA2\u6237"},{label:"\u666E\u901A\u5546\u4E1A\u5BA2\u6237",value:"\u666E\u901A\u5546\u4E1A\u5BA2\u6237"},{label:"\u5408\u540C\u5546\u4E1A\u5BA2\u6237",value:"\u5408\u540C\u5546\u4E1A\u5BA2\u6237"}],tag:"",clientTags:[{label:"\u4EE3\u6263\u5F85\u50AC\u7F34",value:"\u4EE3\u6263\u5F85\u50AC\u7F34"},{label:"\u73B0\u91D1\u5F85\u50AC\u7F34",value:"\u73B0\u91D1\u5F85\u50AC\u7F34"},{label:"\u73B0\u91D1\u4F59\u989D\u4E0D\u8DB3",value:"\u73B0\u91D1\u4F59\u989D\u4E0D\u8DB3"}],payType:"",payTypeOptions:[{label:"\u73B0\u91D1",value:"1"},{label:"\u652F\u4ED8\u5B9D",value:"2"},{label:"\u94F6\u884C\u4EE3\u6263",value:"3"}],leftRange:"",rightRange:"",currentPage:1,total:1,pageSize:100,ascs:"dw1,gridName",descs:"",showScreen:!1,checkAll:!0,checkedHeaders:[],userInfo:{}}},methods:{getTableList(){this.loading=!0,this.tableData=[];let t="",e="";this.leftRange!==""&&(t=parseFloat((Number(this.leftRange)*100).toFixed(10))),this.rightRange!==""&&(e=parseFloat((Number(this.rightRange)*100).toFixed(10))),S.getArrearage({dw1:this.station,gridName:this.gridName,custType:this.client,custTag:this.tag,payType:this.payType,balance1:t,balance2:e,size:this.pageSize,current:this.currentPage,descs:this.descs,ascs:this.ascs}).then(n=>{this.tableData=n.records,this.total=n.total}).finally(()=>{this.loading=!1,this.$nextTick(()=>{this.$refs.arrearage.doLayout()})})},inputNumber(t,e){const n=/^(\-|\+)?\d+(\.\d+)?$/;t==""||n.test(t)?(e=="left"?this.leftRange=t:this.rightRange=t,this.getTableList()):(e=="left"?this.leftRange="":this.rightRange="",this.$message.error("\u8BF7\u8F93\u5165\u6570\u5B57\uFF01"))},change(t){this.station=t?t[0]:"",this.gridName=t&&t.length>1?t[1]:"",this.getTableList()},handleSizeChange(t){this.pageSize=t,this.currentPage=1,this.getTableList()},handleCurrentChange(t){this.currentPage=t,this.getTableList()},sortTable({prop:t,order:e}){e=="ascending"?(this.ascs=t,this.descs=""):e=="descending"?(this.ascs="",this.descs=t):(this.ascs="dw1,gridName",this.descs=""),this.getTableList()},onExport(){let t=[];this.downLoading=!0,S.getArrearage({dw1:this.station,gridName:this.gridName,custType:this.client,payType:this.payType,custTag:this.tag,balance1:this.leftRange?Number(this.leftRange)*100:"",balance2:this.rightRange?Number(this.rightRange)*100:"",size:-1,descs:this.descs,ascs:this.ascs}).then(e=>{t=e.records,e.records.forEach(s=>{s.restBalance=s.restBalance?s.restBalance/100:0,s.payType=s.payType?this.payTypeOptions[s.payType-1].label:""});let n=[],u;for(let s in this.tableHeader)u={title:this.tableHeader[s].label,key:s,type:"text"},n.push(u);U(n,t,"\u6B20\u8D39\u7528\u6237\u660E\u7EC6")}).finally(()=>{this.downLoading=!1})},handleCheckAllChange(t){this.checkedHeaders=t?this.computeCheckedHeaders(b):[],this.showHeader=t?b:[]},computeCheckedHeaders(t){let e=[];for(let n in t)e.push(n);return this.checkedHeaders=e,e},handleCheckedHeaderChange(t){let e=t.length;this.checkAll=e===Object.keys(b).length;let n={};t.forEach(u=>{n[u]=this.allHeader[u]}),this.showHeader=n},clickScreen(){this.showScreen=!0},confirm(){this.tableHeader=this.showHeader,window.localStorage.setItem("arrearage",JSON.stringify(this.tableHeader)),this.showScreen=!1,this.$nextTick(()=>{this.$refs.arrearage.doLayout()})},cancel(){this.showHeader=this.tableHeader,this.showScreen=!1,this.checkAll=Object.keys(this.tableHeader).length===Object.keys(this.computeCheckedHeaders(this.tableHeader)).length}},created(){let t=window.localStorage.getItem("arrearage");this.showHeader=t?JSON.parse(t):b,this.tableHeader=t?JSON.parse(t):b,this.computeCheckedHeaders(this.tableHeader),this.checkAll=Object.keys(this.showHeader).length===Object.keys(b).length,this.userInfo=JSON.parse(E.get("user"));let e=[],n=this.userInfo.grid?this.userInfo.grid.split(","):[];e.push({value:this.userInfo.station,label:this.userInfo.station,children:[]}),n.forEach(u=>{e[0].children.push({value:u,label:u})}),this.stationOptions=this.userInfo.grade=="\u7BA1\u7406\u5458"?window.config.stationOptions:e,this.station_grid=[this.userInfo.station],n.length&&this.station_grid.push(n[0]),this.station=this.userInfo.station,this.gridName=n[0],this.getTableList()}},k=t=>(q("data-v-541b8e59"),t=t(),G(),t),Q={class:"page arrearage"},W={class:"content"},X={class:"toolbox"},Y={class:"left"},Z={class:"search-range"},$=k(()=>o("span",null,"\u8D26\u6237\u4F59\u989D\uFF1A",-1)),ee=k(()=>o("span",{style:{margin:"0 10px"}},"~",-1)),te={class:"right"},le={class:"table"},ae={class:"screen-wrap"},se=k(()=>o("div",{style:{margin:"15px 0"}},null,-1)),ne={key:0},ie={key:1},oe={key:2},re=k(()=>o("div",{style:{"margin-top":"5%"}},"\u6682\u65E0\u6570\u636E",-1)),he={class:"pagination"};function de(t,e,n,u,a,s){const x=c("common-header"),H=c("el-input"),z=c("el-cascader"),C=c("el-option"),v=c("el-select"),T=c("el-button"),O=c("el-tooltip"),N=c("el-checkbox"),I=c("el-checkbox-group"),L=c("el-table-column"),R=c("el-table"),A=c("el-pagination"),B=F("loading");return r(),p("div",Q,[h(x,{title:"\u6B20\u8D39\u7528\u6237\u660E\u7EC6"}),o("div",W,[o("div",X,[o("div",Y,[o("div",Z,[$,h(H,{modelValue:a.leftRange,"onUpdate:modelValue":e[0]||(e[0]=l=>a.leftRange=l),placeholder:"\u6700\u5C0F\u503C",onChange:e[1]||(e[1]=l=>s.inputNumber(l,"left"))},null,8,["modelValue"]),ee,h(H,{modelValue:a.rightRange,"onUpdate:modelValue":e[2]||(e[2]=l=>a.rightRange=l),placeholder:"\u6700\u5927\u503C",onChange:e[3]||(e[3]=l=>s.inputNumber(l,"right"))},null,8,["modelValue"])]),o("div",null,[h(z,{modelValue:a.station_grid,"onUpdate:modelValue":e[4]||(e[4]=l=>a.station_grid=l),style:{width:"300px"},options:a.stationOptions,props:{checkStrictly:a.userInfo.grade!="\u7F51\u683C\u5458"},onChange:s.change,placeholder:"\u4E2D\u5FC3\u53CA\u5E7F\u7535\u7AD9",clearable:a.userInfo.grade=="\u7BA1\u7406\u5458",filterable:""},null,8,["modelValue","options","props","onChange","clearable"])]),o("div",null,[h(v,{clearable:"",onChange:s.getTableList,modelValue:a.client,"onUpdate:modelValue":e[5]||(e[5]=l=>a.client=l),placeholder:"\u5BA2\u6237\u7C7B\u578B"},{default:d(()=>[(r(!0),p(_,null,f(a.clientOptions,l=>(r(),m(C,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["onChange","modelValue"])]),o("div",null,[h(v,{clearable:"",onChange:s.getTableList,modelValue:a.tag,"onUpdate:modelValue":e[6]||(e[6]=l=>a.tag=l),placeholder:"\u5BA2\u6237\u6807\u8BC6"},{default:d(()=>[(r(!0),p(_,null,f(a.clientTags,l=>(r(),m(C,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["onChange","modelValue"])]),o("div",null,[h(v,{clearable:"",onChange:s.getTableList,modelValue:a.payType,"onUpdate:modelValue":e[7]||(e[7]=l=>a.payType=l),placeholder:"\u4EE3\u6263\u7C7B\u578B"},{default:d(()=>[(r(!0),p(_,null,f(a.payTypeOptions,l=>(r(),m(C,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["onChange","modelValue"])])]),o("div",te,[h(T,{type:"primary",onClick:s.onExport,loading:a.downLoading},{default:d(()=>[y("\u5BFC\u51FA\u6570\u636E")]),_:1},8,["onClick","loading"])])]),o("div",le,[h(O,{effect:"dark",content:"\u7B5B\u9009\u8868\u683C\u5217",placement:"top"},{default:d(()=>[o("img",{onClick:e[8]||(e[8]=(...l)=>s.clickScreen&&s.clickScreen(...l)),class:"icon-screen",src:K,alt:""})]),_:1}),h(P,{name:"el-zoom-in-top"},{default:d(()=>[V(o("div",ae,[h(N,{modelValue:a.checkAll,"onUpdate:modelValue":e[9]||(e[9]=l=>a.checkAll=l),onChange:s.handleCheckAllChange},{default:d(()=>[y("\u5168\u9009")]),_:1},8,["modelValue","onChange"]),se,h(I,{modelValue:a.checkedHeaders,"onUpdate:modelValue":e[10]||(e[10]=l=>a.checkedHeaders=l),onChange:s.handleCheckedHeaderChange},{default:d(()=>[(r(!0),p(_,null,f(a.allHeader,(l,i)=>(r(),m(N,{label:i,key:i},{default:d(()=>[y(w(l.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","onChange"]),h(T,{onClick:s.cancel,style:{"margin-top":"20px","margin-right":"20px"},size:"small"},{default:d(()=>[y(" \u53D6\u6D88 ")]),_:1},8,["onClick"]),h(T,{onClick:s.confirm,style:{"margin-top":"20px","margin-right":"20px"},type:"primary",size:"small"},{default:d(()=>[y(" \u786E\u5B9A ")]),_:1},8,["onClick"])],512),[[J,a.showScreen]])]),_:1}),V((r(),m(R,{ref:"arrearage",id:"table",height:"100%",stripe:"",border:"",data:a.tableData,"header-cell-style":{background:"#eaf2fe",color:"#383838",fontSize:"16px",height:"34px"},"cell-class-name":"cell-class","row-style":{height:"24px",fontSize:"14px"},onSortChange:s.sortTable},{empty:d(()=>[re]),default:d(()=>[(r(!0),p(_,null,f(a.tableHeader,(l,i)=>(r(),m(L,{width:"auto","min-width":l.width||100,fixed:i==="dw1"||i==="custName",fit:"",align:"center",sortable:"custom",prop:i,label:l.label},{default:d(g=>[i==="payType"?(r(),p("span",ne,w(g.row[i]!==null&&g.row[i]!==void 0&&g.row[i]!==""&&!!a.payTypeOptions[g.row[i]-1].label?a.payTypeOptions[g.row[i]-1].label:"-"),1)):i==="restBalance"?(r(),p("span",ie,w(g.row[i]==null||g.row[i]==null?"-":g.row[i]/100),1)):(r(),p("span",oe,w(g.row[i]?g.row[i]:"-"),1))]),_:2},1032,["min-width","fixed","prop","label"]))),256))]),_:1},8,["data","onSortChange"])),[[B,a.loading]])]),o("div",he,[h(A,{onSizeChange:s.handleSizeChange,onCurrentChange:s.handleCurrentChange,"current-page":a.currentPage,"page-sizes":[100,200,500,1e3],"page-size":a.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:a.total},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])])])}var me=j(M,[["render",de],["__scopeId","data-v-541b8e59"]]);export{me as default};
