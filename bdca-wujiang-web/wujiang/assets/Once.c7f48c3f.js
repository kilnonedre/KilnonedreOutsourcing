import{C as A}from"./CommonHeader.a228caf3.js";import{d as L}from"./api.22883e35.js";import{_ as J,C as T,a as M,r as g,k as E,o,c as p,d as c,b as h,w as n,T as U,m as O,i as f,F as y,h as k,f as v,D as P,t as w,p as F,q as j}from"./index.22501be6.js";import{t as q}from"./table2excel.fee53b5f.js";import{_ as G}from"./icon_screen.7fe101fd.js";const u={corpOrgId:{label:"\u6240\u5C5E\u533A\u57DFid",width:"150"},custId:{label:"\u5BA2\u6237\u8BC1\u53F7",width:"160"},name:{label:"\u5BA2\u6237\u59D3\u540D",width:"180"},serviceType:{label:"\u4E1A\u52A1\u7C7B\u578B",width:"150"},accTime:{label:"\u53D7\u7406\u65F6\u95F4",width:"150"},billTime:{label:"\u51FA\u7968\u65F6\u95F4",width:"150"},billNumber:{label:"\u53D1\u7968\u53F7\u7801",width:"150"},billCode:{label:"\u53D1\u7968\u4EE3\u7801",width:"120"},wirteBillTime:{label:"\u5F00\u7968\u65F6\u95F4",width:"150"},billType:{label:"\u53D1\u7968\u7C7B\u578B",width:"150"},bossId:{label:"boss\u79D1\u76EEid",width:"150"},bossType:{label:"boss\u79D1\u76EE\u540D\u79F0",width:"150"},billFee:{label:"\u53D1\u7968\u91D1\u989D",width:"150"},billStatus:{label:"\u53D1\u7968\u72B6\u6001",width:"150"},billMode:{label:"payment_mode",width:"180"},chargeType:{label:"\u7F34\u8D39\u65B9\u5F0F",width:"150"},operator:{label:"\u64CD\u4F5C\u5458",width:"150"},serviceHall:{label:"\u8425\u4E1A\u5385",width:"150"},originalBillNumber:{label:"\u539F\u53D1\u7968\u53F7\u7801",width:"150"},originalBillCode:{label:"\u539F\u53D1\u7968\u4EE3\u7801",width:"150"},tradeDate:{label:"\u4EA4\u6613\u65F6\u95F4",width:"150"},remark:{label:"\u5907\u6CE8",width:"150"},etlDate:{label:"\u6570\u636E\u5165\u5E93\u65F6\u95F4",width:"160"},dw1:{label:"\u4E2D\u5FC3\u53CA\u5E7F\u7535\u7AD9",width:"180"}},K={components:{CommonHeader:A},data(){return{date:"",dw1:"",stationOptions:["\u5F00\u53D1\u533A\u5E7F\u7535\u4E2D\u5FC3","\u6C7E\u6E56\u5E7F\u7535\u4E2D\u5FC3","\u9AD8\u65B0\u533A\u5E7F\u7535\u4E2D\u5FC3","\u5434\u6C5F\u4E1C\u592A\u6E56\u4E2D\u5FC3","\u4E03\u90FD\u5E7F\u7535\u7AD9","\u6843\u6E90\u5E7F\u7535\u7AD9","\u9707\u6CFD\u5E7F\u7535\u7AD9","\u5E73\u671B\u5E7F\u7535\u7AD9","\u6A2A\u6247\u5E7F\u7535\u7AD9"],userInfo:{},serviceHall:"",serviceHallList:[],bossType:"",bossTypeList:[],downLoading:!1,loading:!1,showScreen:!1,checkAll:!0,checkedHeaders:[],showHeader:[],allHeader:u,tableHeader:{},tableData:[],ascs:"",descs:"",currentPage:1,total:1,pageSize:100}},methods:{async initList(){await L.getOnce({size:-1}).then(e=>{e.records.forEach(t=>{t.serviceHall!=null&&this.serviceHallList.indexOf(t.serviceHall)==-1&&this.serviceHallList.push(t.serviceHall),window.localStorage.setItem("serviceHallList",JSON.stringify(this.serviceHallList)),t.bossType!=null&&this.bossTypeList.indexOf(t.bossType)==-1&&this.bossTypeList.push(t.bossType),window.localStorage.setItem("bossTypeList",JSON.stringify(this.bossTypeList))})})},getTableList(){this.loading=!0,this.tableData=[],L.getOnce({size:this.pageSize,current:this.currentPage,date1:T(this.date)?this.date[0]:"",date2:T(this.date)?this.date[1]:"",dw1:this.dw1,serviceHall:this.serviceHall,bossType:this.bossType,descs:this.descs,ascs:this.ascs}).then(e=>{this.tableData=e.records,this.total=e.total}).finally(()=>{this.loading=!1,this.$nextTick(()=>{this.$refs.once.doLayout()})})},changeTime(){this.getTableList()},getDay(e,t){var r=new Date,b=r.getTime(),a=24*3600*1e3*e;r.setTime(parseInt(b+a));var l=r.getFullYear(),m=(r.getMonth()+1).toString();m.length<=1&&(m="0"+m);var _=r.getDate().toString();return _.length<=1&&(_="0"+_),l+t+m+t+_},handleSizeChange(e){this.pageSize=e,this.currentPage=1,this.getTableList()},handleCurrentChange(e){this.currentPage=e,this.getTableList()},sortTable({prop:e,order:t}){t=="ascending"?(this.ascs=e,this.descs=""):t=="descending"?(this.ascs="",this.descs=e):(this.ascs="",this.descs=""),this.getTableList()},onExport(){let e=[];this.downLoading=!0,L.getOnce({size:-1,date1:T(this.date)?this.date[0]:"",date2:T(this.date)?this.date[1]:"",dw1:this.dw1,serviceHall:this.serviceHall,bossType:this.bossType,descs:this.descs,ascs:this.ascs}).then(t=>{e=t.records,t.records.forEach(l=>{l.accTime=l.accTime?l.accTime.split(" ")[0]:"-",l.billTime=l.billTime?l.billTime.split(" ")[0]:"-",l.wirteBillTime=l.wirteBillTime?l.wirteBillTime.split(" ")[0]:"-",l.tradeDate=l.tradeDate?l.tradeDate.split(" ")[0]:"-",l.etlDate=l.etlDate?l.etlDate.split(" ")[0]:"-"});let r=[],b;for(let l in this.tableHeader)b={title:this.tableHeader[l].label,key:l,type:"text"},r.push(b);q(r,e,"\u4E00\u6B21\u6027\u8D39\u7528\u660E\u7EC6")}).finally(()=>{this.downLoading=!1})},clickScreen(){this.showScreen=!0},handleCheckAllChange(e){this.checkedHeaders=e?this.computeCheckedHeaders(u):[],this.showHeader=e?u:[]},computeCheckedHeaders(e){let t=[];for(let r in e)t.push(r);return this.checkedHeaders=t,t},handleCheckedHeaderChange(e){let t=e.length;this.checkAll=t===Object.keys(u).length;let r={};e.forEach(b=>{r[b]=this.allHeader[b]}),this.showHeader=r},confirm(){this.tableHeader=this.showHeader,window.localStorage.setItem("once",JSON.stringify(this.tableHeader)),this.showScreen=!1,this.$nextTick(()=>{this.$refs.once.doLayout()})},cancel(){this.showHeader=this.tableHeader,this.showScreen=!1,this.checkAll=Object.keys(this.tableHeader).length===Object.keys(this.computeCheckedHeaders(this.tableHeader)).length}},created(){this.date=[this.getDay(-1,"/"),this.getDay(-1,"/")];let e=window.localStorage.getItem("once");this.showHeader=e?JSON.parse(e):u,this.tableHeader=e?JSON.parse(e):u,this.computeCheckedHeaders(this.tableHeader),this.checkAll=Object.keys(this.showHeader).length===Object.keys(u).length,this.tableHeader=u,this.userInfo=JSON.parse(M.get("user")),this.dw1=this.userInfo.station,e=window.localStorage.getItem("serviceHallList"),this.serviceHallList=e?JSON.parse(e):[],e=window.localStorage.getItem("bossTypeList"),this.bossTypeList=e?JSON.parse(e):[],(this.serviceHallList.length==0||this.bossTypeList.length==0)&&this.initList(),this.getTableList()}},V=e=>(F("data-v-14f92521"),e=e(),j(),e),Q={class:"page order"},R={class:"content"},W={class:"tab-content"},X={class:"toolbox"},Z={class:"left"},$={class:"right"},ee={class:"table"},te={class:"screen-wrap"},le=V(()=>h("div",{style:{margin:"15px 0"}},null,-1)),se={key:0},ae={key:1},ie={key:2},oe={key:3},re={key:4},ne={key:5,style:{"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},he=V(()=>h("div",{style:{"margin-top":"5%"}},"\u6682\u65E0\u6570\u636E",-1)),ce={class:"pagination"};function de(e,t,r,b,a,l){const m=g("common-header"),_=g("el-date-picker"),H=g("el-option"),C=g("el-select"),S=g("el-button"),z=g("el-tooltip"),D=g("el-checkbox"),I=g("el-checkbox-group"),x=g("el-table-column"),N=g("el-table"),B=g("el-pagination"),Y=E("loading");return o(),p("div",Q,[c(m,{title:"\u4E00\u6B21\u6027\u8D39\u7528\u660E\u7EC6"}),h("div",R,[h("div",W,[h("div",X,[h("div",Z,[h("div",null,[c(_,{modelValue:a.date,"onUpdate:modelValue":t[0]||(t[0]=s=>a.date=s),type:"daterange",format:"YYYY-MM-DD","value-format":"YYYY/MM/DD","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F",style:{width:"250px"},onChange:l.changeTime},null,8,["modelValue","onChange"])]),c(C,{modelValue:a.dw1,"onUpdate:modelValue":t[1]||(t[1]=s=>a.dw1=s),disabled:a.userInfo.grade!=="\u7BA1\u7406\u5458",placeholder:"\u4E2D\u5FC3\u53CA\u5E7F\u7535\u7AD9",clearable:"",onChange:l.getTableList},{default:n(()=>[(o(!0),p(y,null,k(a.stationOptions,s=>(o(),f(H,{key:s,label:s,value:s},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled","onChange"]),h("div",null,[c(C,{modelValue:a.serviceHall,"onUpdate:modelValue":t[2]||(t[2]=s=>a.serviceHall=s),placeholder:"\u8425\u4E1A\u5385",filterable:"",clearable:"",onChange:l.getTableList},{default:n(()=>[(o(!0),p(y,null,k(a.serviceHallList,s=>(o(),f(H,{key:s,label:s,value:s},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),h("div",null,[c(C,{modelValue:a.bossType,"onUpdate:modelValue":t[3]||(t[3]=s=>a.bossType=s),placeholder:"boss\u79D1\u76EE\u540D\u79F0",filterable:"",clearable:"",onChange:l.getTableList},{default:n(()=>[(o(!0),p(y,null,k(a.bossTypeList,s=>(o(),f(H,{key:s,label:s,value:s},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])])]),h("div",$,[c(S,{type:"primary",onClick:l.onExport,loading:a.downLoading},{default:n(()=>[v(" \u5BFC\u51FA\u6570\u636E ")]),_:1},8,["onClick","loading"])])]),h("div",ee,[c(z,{effect:"dark",content:"\u7B5B\u9009\u8868\u683C\u5217",placement:"top"},{default:n(()=>[h("img",{onClick:t[4]||(t[4]=(...s)=>l.clickScreen&&l.clickScreen(...s)),class:"icon-screen",src:G,alt:""})]),_:1}),c(U,{name:"el-zoom-in-top"},{default:n(()=>[O(h("div",te,[c(D,{modelValue:a.checkAll,"onUpdate:modelValue":t[5]||(t[5]=s=>a.checkAll=s),onChange:l.handleCheckAllChange},{default:n(()=>[v("\u5168\u9009")]),_:1},8,["modelValue","onChange"]),le,c(I,{modelValue:a.checkedHeaders,"onUpdate:modelValue":t[6]||(t[6]=s=>a.checkedHeaders=s),onChange:l.handleCheckedHeaderChange},{default:n(()=>[(o(!0),p(y,null,k(a.allHeader,(s,i)=>(o(),f(D,{label:i,key:i},{default:n(()=>[v(w(s.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","onChange"]),c(S,{onClick:l.cancel,style:{"margin-top":"20px","margin-right":"20px"},size:"small"},{default:n(()=>[v("\u53D6\u6D88 ")]),_:1},8,["onClick"]),c(S,{onClick:l.confirm,style:{"margin-top":"20px","margin-right":"20px"},type:"primary",size:"small"},{default:n(()=>[v("\u786E\u5B9A ")]),_:1},8,["onClick"])],512),[[P,a.showScreen]])]),_:1}),O((o(),f(N,{ref:"once",height:"100%",stripe:"",border:"",data:a.tableData,"header-cell-style":{background:"#eaf2fe",color:"#383838",fontSize:"16px",height:"34px"},"row-style":{height:"24px",fontSize:"14px"},onSortChange:l.sortTable},{empty:n(()=>[he]),default:n(()=>[(o(!0),p(y,null,k(a.tableHeader,(s,i)=>(o(),f(x,{label:s.label,prop:i,align:"center","min-width":s.width?s.width+"":"100",sortable:"custom"},{default:n(d=>[i==="accTime"?(o(),p("span",se,w(d.row[i]?d.row[i].split(" ")[0]:"-"),1)):i==="billTime"?(o(),p("span",ae,w(d.row[i]?d.row[i].split(" ")[0]:"-"),1)):i==="wirteBillTime"?(o(),p("span",ie,w(d.row[i]?d.row[i].split(" ")[0]:"-"),1)):i==="tradeDate"?(o(),p("span",oe,w(d.row[i]?d.row[i].split(" ")[0]:"-"),1)):i==="etlDate"?(o(),p("span",re,w(d.row[i]?d.row[i].split(" ")[0]:"-"),1)):(o(),p("span",ne,w(d.row[i]?d.row[i]:"-"),1))]),_:2},1032,["label","prop","min-width"]))),256))]),_:1},8,["data","onSortChange"])),[[Y,a.loading]])]),h("div",ce,[c(B,{"current-page":a.currentPage,"page-size":a.pageSize,"page-sizes":[20,30,50,100],total:a.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:l.handleSizeChange,onCurrentChange:l.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])])])}var me=J(K,[["render",de],["__scopeId","data-v-14f92521"]]);export{me as default};
