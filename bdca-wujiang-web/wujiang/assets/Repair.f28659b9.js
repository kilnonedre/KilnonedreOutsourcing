import{C as Y}from"./CommonHeader.a228caf3.js";import{d as V}from"./api.22883e35.js";import{_ as A,C,a as E,r as c,k as M,o as i,c as u,d as r,b as o,w as h,T as P,m as H,i as g,F as m,h as b,f as k,D as F,p as B,q,t as v}from"./index.22501be6.js";import{t as G}from"./table2excel.fee53b5f.js";import{_ as K}from"./icon_screen.7fe101fd.js";const w={woNbr:{label:"\u5DE5\u5355\u53F7",width:"120"},businessName:{label:"\u7EF4\u4FEE\u7C7B\u578B",width:"200"},custId:{label:"\u5BA2\u6237\u8BC1\u53F7",width:"150"},custName:{label:"\u5BA2\u6237\u59D3\u540D",width:"120"},contactInfo:{label:"\u8054\u7CFB\u4FE1\u606F",width:"400"},situated:{label:"\u5730\u5740",width:"450"},faulttypename:{label:"\u6545\u969C\u79CD\u7C7B",width:"180"},faultphenomname:{label:"\u6545\u969C\u73B0\u8C61",width:"180"},faultreason:{label:"\u6545\u969C\u539F\u56E0",width:"180"},station:{label:"\u4E2D\u5FC3\u53CA\u5E7F\u7535\u7AD9",width:"180"},gridName:{label:"\u7F51\u683C\u540D\u79F0",width:"180"},exchId:{label:"\u7F51\u683CID",width:"180"},runSts:{label:"\u5DE5\u5355\u72B6\u6001",width:"120"},soStaffName:{label:"\u53D7\u7406\u4EBA",width:"120"},executeStaffName:{label:"\u65BD\u5DE5\u5458",width:"120"},createDate:{label:"\u5DE5\u5355\u751F\u4EA7\u65F6\u95F4",width:"160"},asgnDate:{label:"\u6D3E\u5355\u65F6\u95F4",width:"140"},completeDate:{label:"\u5B8C\u6210\u65F6\u95F4",width:"140"},bookTime:{label:"\u9884\u7EA6\u65F6\u95F4",width:"140"},remarks:{label:"\u5907\u6CE8",width:"450"},surveyStaffName:{label:"\u56DE\u8BBF\u5458",width:"120"},stsWords:{label:"\u56DE\u8BBF\u7ED3\u679C",width:"120"},dissatisfiedReason:{label:"\u4E0D\u6EE1\u610F\u539F\u56E0",width:"140"},mainProd:{label:"\u4E3B\u673A\u6807\u8BC6",width:"120"},accessWay:{label:"\u63A5\u5165\u65B9\u5F0F",width:"120"},handleTypeName:{label:"\u64CD\u4F5C\u7C7B\u578B",width:"200"},isovertime:{label:"\u662F\u5426\u8D85\u65F6",width:"120"},completeMin:{label:"\u5B8C\u6210\u65F6\u957F(\u5206\u949F)",width:"160"},orderRank:{label:"\u5BA2\u6237\u6309\u6708\u5DE5\u5355\u6392\u5E8F",width:"200"}},Q={components:{CommonHeader:Y},data(){return{date:"",station:"",gridName:"",station_grid:[],stationOptions:[],userInfo:{},businessName:[],businessList:[],runSts:"",runStsList:["C","D","P"],faulttypename:[],faultTypeList:[],executeStaffName:"",staffList:[],stsWords:"",stsWordsList:[],dissatisfiedReason:"",dissatisfiedReasonList:[],isovertime:"",isovertimeList:["\u662F","\u5426"],complete1:void 0,complete2:void 0,downLoading:!1,loading:!1,showScreen:!1,checkAll:!0,checkedHeaders:[],showHeader:[],allHeader:w,tableHeader:{},tableData:[],ascs:"",descs:"",currentPage:1,total:1,pageSize:100}},methods:{async initList(){await V.getRepaired({size:-1}).then(s=>{s.records.forEach(e=>{e.businessName!=null&&this.businessList.indexOf(e.businessName)==-1&&this.businessList.push(e.businessName),window.localStorage.setItem("businessListForRepair",JSON.stringify(this.businessList)),e.faulttypename!=null&&this.faultTypeList.indexOf(e.faulttypename)==-1&&this.faultTypeList.push(e.faulttypename),window.localStorage.setItem("faultTypeList",JSON.stringify(this.faultTypeList)),e.executeStaffName!=null&&this.staffList.indexOf(e.executeStaffName)==-1&&this.staffList.push(e.executeStaffName),window.localStorage.setItem("staffList",JSON.stringify(this.staffList)),e.stsWords!=null&&this.stsWordsList.indexOf(e.stsWords)==-1&&this.stsWordsList.push(e.stsWords),window.localStorage.setItem("stsWordsList",JSON.stringify(this.stsWordsList)),e.dissatisfiedReason!=null&&this.dissatisfiedReasonList.indexOf(e.dissatisfiedReason)==-1&&this.dissatisfiedReasonList.push(e.dissatisfiedReason),window.localStorage.setItem("dissatisfiedReasonList",JSON.stringify(this.dissatisfiedReasonList))})})},getTableList(){this.loading=!0,this.tableData=[],V.getRepaired({size:this.pageSize,current:this.currentPage,date1:C(this.date)?this.date[0]:"",date2:C(this.date)?this.date[1]:"",station:this.station,gridName:this.gridName,businessNameSet:this.businessName.join(),runSts:this.runSts,faulttypeNameSet:this.faulttypename.join(),executeStaffName:this.executeStaffName,stsWords:this.stsWords,dissatisfiedReason:this.dissatisfiedReason,isovertime:this.isovertime,complete1:this.complete1,complete2:this.complete2,descs:this.descs,ascs:this.ascs}).then(s=>{this.tableData=s.records,this.total=s.total}).finally(()=>{this.loading=!1,this.$nextTick(()=>{this.$refs.repair.doLayout()})})},changeTime(){this.getTableList()},changeStation(s){this.station=s?s[0]:"",this.gridName=s&&s.length>1?s[1]:"",this.getTableList()},getDay(s,e){var n=new Date,p=n.getTime(),l=24*3600*1e3*s;n.setTime(parseInt(p+l));var a=n.getFullYear(),S=(n.getMonth()+1).toString();S.length<=1&&(S="0"+S);var L=n.getDate().toString();return L.length<=1&&(L="0"+L),a+e+S+e+L},inputNumber(s,e){const n=/^(\-|\+)?\d+(\.\d+)?$/;s==""||s==null||n.test(s)?(e=="left"?this.complete1=s:this.complete2=s,this.getTableList()):(e=="left"?this.complete1=void 0:this.complete2=void 0,this.$message.error("\u8BF7\u8F93\u5165\u6570\u5B57\uFF01"),this.getTableList())},handleSizeChange(s){this.pageSize=s,this.currentPage=1,this.getTableList()},handleCurrentChange(s){this.currentPage=s,this.getTableList()},sortTable({prop:s,order:e}){e=="ascending"?(this.ascs=s,this.descs=""):e=="descending"?(this.ascs="",this.descs=s):(this.ascs="",this.descs=""),this.getTableList()},onExport(){let s=[];this.downLoading=!0,V.getRepaired({size:-1,date1:C(this.date)?this.date[0]:"",date2:C(this.date)?this.date[1]:"",station:this.station,gridName:this.gridName,businessNameSet:this.businessName.join(),runSts:this.runSts,faulttypeNameSet:this.faulttypename.join(),executeStaffName:this.executeStaffName,stsWords:this.stsWords,dissatisfiedReason:this.dissatisfiedReason,isovertime:this.isovertime,complete1:this.complete1,complete2:this.complete2,descs:this.descs,ascs:this.ascs}).then(e=>{s=e.records,e.records.forEach(a=>{a.createDate=a.createDate?a.createDate.split(" ")[0]:"-",a.asgnDate=a.asgnDate?a.asgnDate.split(" ")[0]:"-",a.completeDate=a.completeDate?a.completeDate.split(" ")[0]:"-",a.bookTime=a.bookTime?a.bookTime.split(" ")[0]:"-"});let n=[],p;for(let a in this.tableHeader)p={title:this.tableHeader[a].label,key:a,type:"text"},n.push(p);G(n,s,"\u7EF4\u4FEE\u5DE5\u5355\u660E\u7EC6")}).finally(()=>{this.downLoading=!1})},clickScreen(){this.showScreen=!0},handleCheckAllChange(s){this.checkedHeaders=s?this.computeCheckedHeaders(w):[],this.showHeader=s?w:[]},computeCheckedHeaders(s){let e=[];for(let n in s)e.push(n);return this.checkedHeaders=e,e},handleCheckedHeaderChange(s){let e=s.length;this.checkAll=e===Object.keys(w).length;let n={};s.forEach(p=>{n[p]=this.allHeader[p]}),this.showHeader=n},confirm(){this.tableHeader=this.showHeader,window.localStorage.setItem("repair",JSON.stringify(this.tableHeader)),this.showScreen=!1,this.$nextTick(()=>{this.$refs.repair.doLayout()})},cancel(){this.showHeader=this.tableHeader,this.showScreen=!1,this.checkAll=Object.keys(this.tableHeader).length===Object.keys(this.computeCheckedHeaders(this.tableHeader)).length}},created(){this.date=[this.getDay(-1,"/"),this.getDay(-1,"/")];let s=window.localStorage.getItem("repair");this.showHeader=s?JSON.parse(s):w,this.tableHeader=s?JSON.parse(s):w,this.computeCheckedHeaders(this.tableHeader),this.checkAll=Object.keys(this.showHeader).length===Object.keys(w).length,this.tableHeader=w,this.userInfo=JSON.parse(E.get("user"));let e=[],n=this.userInfo.grid?this.userInfo.grid.split(","):[];e.push({value:this.userInfo.station,label:this.userInfo.station,children:[]}),n.forEach(p=>{e[0].children.push({value:p,label:p})}),this.stationOptions=this.userInfo.grade=="\u7BA1\u7406\u5458"?window.config.stationOptions:e,this.station_grid=[this.userInfo.station],n.length&&this.station_grid.push(n[0]),this.station=this.userInfo.station,this.gridName=n[0],s=window.localStorage.getItem("businessListForRepair"),this.businessList=s?JSON.parse(s):[],s=window.localStorage.getItem("faultTypeList"),this.faultTypeList=s?JSON.parse(s):[],s=window.localStorage.getItem("staffList"),this.staffList=s?JSON.parse(s):[],s=window.localStorage.getItem("stsWordsList"),this.stsWordsList=s?JSON.parse(s):[],s=window.localStorage.getItem("dissatisfiedReasonList"),this.dissatisfiedReasonList=s?JSON.parse(s):[],(this.businessList.length==0||this.faultTypeList.length==0||this.staffList.length==0||this.stsWordsList.length==0||this.dissatisfiedReasonList.length==0)&&this.initList(),this.getTableList()}},N=s=>(B("data-v-491f2837"),s=s(),q(),s),X={class:"page order"},Z={class:"content"},j={class:"tab-content"},$={class:"toolbox"},ee={class:"left"},te={class:"level"},se={class:"level"},le={class:"search-range"},ae=N(()=>o("span",{style:{"font-size":"15px",width:"130px"}},"\u7EF4\u4FEE\u65F6\u957F\uFF08\u5206\u949F\uFF09:",-1)),ie=N(()=>o("span",{style:{margin:"0 10px"}},"~",-1)),oe={class:"right"},ne={class:"table"},re={class:"screen-wrap"},de=N(()=>o("div",{style:{margin:"15px 0"}},null,-1)),he={key:0},ue={key:1},ce={key:2},pe={key:3},fe={key:4,style:{"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},ge=N(()=>o("div",{style:{"margin-top":"5%"}},"\u6682\u65E0\u6570\u636E",-1)),me={class:"pagination"};function be(s,e,n,p,l,a){const S=c("common-header"),L=c("el-date-picker"),I=c("el-cascader"),_=c("el-option"),y=c("el-select"),x=c("el-input-number"),T=c("el-button"),O=c("el-tooltip"),D=c("el-checkbox"),R=c("el-checkbox-group"),z=c("el-table-column"),W=c("el-table"),J=c("el-pagination"),U=M("loading");return i(),u("div",X,[r(S,{title:"\u7EF4\u4FEE\u5DE5\u5355\u660E\u7EC6"}),o("div",Z,[o("div",j,[o("div",$,[o("div",ee,[o("div",te,[o("div",null,[r(L,{modelValue:l.date,"onUpdate:modelValue":e[0]||(e[0]=t=>l.date=t),type:"daterange",format:"YYYY-MM-DD","value-format":"YYYY/MM/DD","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F",style:{width:"250px"},onChange:a.changeTime},null,8,["modelValue","onChange"])]),o("div",null,[r(I,{modelValue:l.station_grid,"onUpdate:modelValue":e[1]||(e[1]=t=>l.station_grid=t),style:{width:"250px"},options:l.stationOptions,props:{checkStrictly:l.userInfo.grade!="\u7F51\u683C\u5458"},onChange:a.changeStation,placeholder:"\u4E2D\u5FC3\u53CA\u5E7F\u7535\u7AD9",clearable:l.userInfo.grade=="\u7BA1\u7406\u5458",filterable:""},null,8,["modelValue","options","props","onChange","clearable"])]),o("div",null,[r(y,{modelValue:l.businessName,"onUpdate:modelValue":e[2]||(e[2]=t=>l.businessName=t),placeholder:"\u7EF4\u4FEE\u7C7B\u578B",multiple:"","collapse-tags":"","collapse-tags-tooltip":"",filterable:"",clearable:"",onChange:a.getTableList},{default:h(()=>[(i(!0),u(m,null,b(l.businessList,t=>(i(),g(_,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),o("div",null,[r(y,{modelValue:l.runSts,"onUpdate:modelValue":e[3]||(e[3]=t=>l.runSts=t),placeholder:"\u5DE5\u5355\u72B6\u6001",filterable:"",clearable:"",onChange:a.getTableList},{default:h(()=>[(i(!0),u(m,null,b(l.runStsList,t=>(i(),g(_,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),o("div",null,[r(y,{modelValue:l.faulttypename,"onUpdate:modelValue":e[4]||(e[4]=t=>l.faulttypename=t),placeholder:"\u6545\u969C\u79CD\u7C7B",multiple:"","collapse-tags":"","collapse-tags-tooltip":"",filterable:"",clearable:"",onChange:a.getTableList},{default:h(()=>[(i(!0),u(m,null,b(l.faultTypeList,t=>(i(),g(_,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])])]),o("div",se,[o("div",null,[r(y,{modelValue:l.executeStaffName,"onUpdate:modelValue":e[5]||(e[5]=t=>l.executeStaffName=t),placeholder:"\u65BD\u5DE5\u5458",filterable:"",clearable:"",onChange:a.getTableList},{default:h(()=>[(i(!0),u(m,null,b(l.staffList,t=>(i(),g(_,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),o("div",null,[r(y,{modelValue:l.stsWords,"onUpdate:modelValue":e[6]||(e[6]=t=>l.stsWords=t),placeholder:"\u7535\u8BDD\u56DE\u8BBF\u7ED3\u679C",filterable:"",clearable:"",onChange:a.getTableList},{default:h(()=>[(i(!0),u(m,null,b(l.stsWordsList,t=>(i(),g(_,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),o("div",null,[r(y,{modelValue:l.dissatisfiedReason,"onUpdate:modelValue":e[7]||(e[7]=t=>l.dissatisfiedReason=t),placeholder:"\u4E0D\u6EE1\u610F\u539F\u56E0",filterable:"",clearable:"",onChange:a.getTableList},{default:h(()=>[(i(!0),u(m,null,b(l.dissatisfiedReasonList,t=>(i(),g(_,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),o("div",null,[r(y,{modelValue:l.isovertime,"onUpdate:modelValue":e[8]||(e[8]=t=>l.isovertime=t),placeholder:"\u662F\u5426\u8D85\u65F6",clearable:"",onChange:a.getTableList},{default:h(()=>[(i(!0),u(m,null,b(l.isovertimeList,t=>(i(),g(_,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),o("div",le,[ae,r(x,{style:{width:"150px"},modelValue:l.complete1,"onUpdate:modelValue":e[9]||(e[9]=t=>l.complete1=t),min:0,precision:0,placeholder:"\u6700\u5C0F\u503C",onChange:e[10]||(e[10]=t=>a.inputNumber(t,"left"))},null,8,["modelValue"]),ie,r(x,{style:{width:"150px"},min:0,precision:0,modelValue:l.complete2,"onUpdate:modelValue":e[11]||(e[11]=t=>l.complete2=t),placeholder:"\u6700\u5927\u503C",onChange:e[12]||(e[12]=t=>a.inputNumber(t,"right"))},null,8,["modelValue"])])])]),o("div",oe,[r(T,{type:"primary",onClick:a.onExport,loading:l.downLoading},{default:h(()=>[k(" \u5BFC\u51FA\u6570\u636E ")]),_:1},8,["onClick","loading"])])]),o("div",ne,[r(O,{effect:"dark",content:"\u7B5B\u9009\u8868\u683C\u5217",placement:"top"},{default:h(()=>[o("img",{onClick:e[13]||(e[13]=(...t)=>a.clickScreen&&a.clickScreen(...t)),class:"icon-screen",src:K,alt:""})]),_:1}),r(P,{name:"el-zoom-in-top"},{default:h(()=>[H(o("div",re,[r(D,{modelValue:l.checkAll,"onUpdate:modelValue":e[14]||(e[14]=t=>l.checkAll=t),onChange:a.handleCheckAllChange},{default:h(()=>[k("\u5168\u9009")]),_:1},8,["modelValue","onChange"]),de,r(R,{modelValue:l.checkedHeaders,"onUpdate:modelValue":e[15]||(e[15]=t=>l.checkedHeaders=t),onChange:a.handleCheckedHeaderChange},{default:h(()=>[(i(!0),u(m,null,b(l.allHeader,(t,d)=>(i(),g(D,{label:d,key:d},{default:h(()=>[k(v(t.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","onChange"]),r(T,{onClick:a.cancel,style:{"margin-top":"20px","margin-right":"20px"},size:"small"},{default:h(()=>[k("\u53D6\u6D88 ")]),_:1},8,["onClick"]),r(T,{onClick:a.confirm,style:{"margin-top":"20px","margin-right":"20px"},type:"primary",size:"small"},{default:h(()=>[k("\u786E\u5B9A ")]),_:1},8,["onClick"])],512),[[F,l.showScreen]])]),_:1}),H((i(),g(W,{ref:"repair",height:"100%",stripe:"",border:"",data:l.tableData,"header-cell-style":{background:"#eaf2fe",color:"#383838",fontSize:"16px",height:"34px"},"row-style":{height:"24px",fontSize:"14px"},onSortChange:a.sortTable},{empty:h(()=>[ge]),default:h(()=>[(i(!0),u(m,null,b(l.tableHeader,(t,d)=>(i(),g(z,{label:t.label,prop:d,align:"center","min-width":t.width?t.width+"":"100",sortable:"custom"},{default:h(f=>[d==="createDate"?(i(),u("span",he,v(f.row[d]?f.row[d].split(" ")[0]:"-"),1)):d==="asgnDate"?(i(),u("span",ue,v(f.row[d]?f.row[d].split(" ")[0]:"-"),1)):d==="completeDate"?(i(),u("span",ce,v(f.row[d]?f.row[d].split(" ")[0]:"-"),1)):d==="bookTime"?(i(),u("span",pe,v(f.row[d]?f.row[d].split(" ")[0]:"-"),1)):(i(),u("span",fe,v(f.row[d]?f.row[d]:"-"),1))]),_:2},1032,["label","prop","min-width"]))),256))]),_:1},8,["data","onSortChange"])),[[U,l.loading]])]),o("div",me,[r(J,{"current-page":l.currentPage,"page-size":l.pageSize,"page-sizes":[20,30,50,100],total:l.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:a.handleSizeChange,onCurrentChange:a.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])])])}var ve=A(Q,[["render",be],["__scopeId","data-v-491f2837"]]);export{ve as default};
