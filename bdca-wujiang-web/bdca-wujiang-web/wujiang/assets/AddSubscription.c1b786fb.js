import{s as p,a as V}from"./api.22883e35.js";import{s as U,o as i,c as f,b as w,_ as $,a as N,r as a,d as u,w as r,f as c,F as B,h as L,i as h,t as m,l as g}from"./index.22501be6.js";var y=(s,t)=>{const l=s.__vccOpts||s;for(const[d,e]of t)l[d]=e;return l};const A=U({name:"Minus"}),O={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},S=w("path",{fill:"currentColor",d:"M128 544h768a32 32 0 1 0 0-64H128a32 32 0 0 0 0 64z"},null,-1),F=[S];function M(s,t,l,d,e,n){return i(),f("svg",O,F)}var z=y(A,[["render",M]]);const D=U({name:"Plus"}),H={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},T=w("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64h352z"},null,-1),P=[T];function j(s,t,l,d,e,n){return i(),f("svg",H,P)}var q=y(D,[["render",j]]);const E={name:"AddSubscription",components:{Plus:q,Minus:z},emits:["over"],data(){return{show:!1,loading:!1,stationOptions:window.config.stationOptions,rules:{user:[{required:!0,message:"\u8BF7\u9009\u62E9\u7528\u6237",trigger:"change"}]},station_grid:"",gridName:"",station:"",userInfo:"",userList:[],selectUser:"",form:{user:""}}},methods:{reset(){this.$refs.form.resetFields(),this.selectUser="",this.show=!1,this.$emit("over")},submit(){this.$refs.form.validate(s=>{s&&(this.loading=!0,this.$route.path.includes("TV")?p.subsTelevision({userId:this.form.user.split("/")[0],touser:this.form.user.split("/")[1],dw1:this.selectUser.station,gridName:this.selectUser.grid,test:!0}).then(t=>{this.$message.success("\u8BA2\u9605\u6210\u529F\uFF01"),this.show=!1}).finally(()=>{this.loading=!1}):this.$route.path.includes("FDDI")?p.subsBroadband({userId:this.form.user.split("/")[0],touser:this.form.user.split("/")[1],dw1:this.selectUser.station,gridName:this.selectUser.grid,test:!0}).then(t=>{this.$message.success("\u8BA2\u9605\u6210\u529F\uFF01"),this.show=!1}).finally(()=>{this.loading=!1}):this.$route.path.includes("Arrearage")&&p.subsArrearage({userId:this.form.user.split("/")[0],touser:this.form.user.split("/")[1],dw1:this.selectUser.station,gridName:this.selectUser.grid,test:!0}).then(t=>{this.$message.success("\u8BA2\u9605\u6210\u529F\uFF01"),this.show=!1}).finally(()=>{this.loading=!1}))})},getUserList(){V.getUser({size:-1}).then(s=>{this.userList=s.records})},change(s){let t=this.userList.find(l=>l.id===s.split("/")[0]);this.selectUser=t},open(){this.userInfo=JSON.parse(N.get("user"));let s=[];this.userInfo.station&&s.push(this.userInfo.station),this.userInfo.grid&&s.push(this.userInfo.grid),this.station_grid=s,this.station=this.userInfo.station,this.gridName=this.userInfo.grid,this.getUserList()}}},J={class:"dialog-footer"};function G(s,t,l,d,e,n){const x=a("el-option"),k=a("el-select"),v=a("el-form-item"),_=a("el-tag"),C=a("el-form"),b=a("el-button"),I=a("el-dialog");return i(),f("div",null,[u(I,{"destroy-on-close":"","close-on-click-modal":!1,"close-on-press-escape":!1,onOpen:n.open,onClosed:n.reset,width:"500px",modelValue:e.show,"onUpdate:modelValue":t[1]||(t[1]=o=>e.show=o),title:"\u6DFB\u52A0\u8BA2\u9605"},{footer:r(()=>[w("span",J,[u(b,{onClick:n.reset},{default:r(()=>[c("\u53D6\u6D88")]),_:1},8,["onClick"]),u(b,{loading:e.loading,type:"primary",onClick:n.submit},{default:r(()=>[c("\u786E\u5B9A")]),_:1},8,["loading","onClick"])])]),default:r(()=>[u(C,{"label-width":"60px","label-position":"left",rules:e.rules,ref:"form",model:e.form},{default:r(()=>[u(v,{label:"\u7528\u6237",prop:"user"},{default:r(()=>[u(k,{modelValue:e.form.user,"onUpdate:modelValue":t[0]||(t[0]=o=>e.form.user=o),style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u7528\u6237",filterable:"",onChange:n.change},{default:r(()=>[(i(!0),f(B,null,L(e.userList,o=>(i(),h(x,{key:o.id,label:o.usernick+"("+o.username+")",value:o.id+"/"+o.touser},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1}),u(v,null,{default:r(()=>[e.selectUser.grade?(i(),h(_,{key:0,style:{"margin-right":"10px"}},{default:r(()=>[c(m(e.selectUser.grade),1)]),_:1})):g("",!0),e.selectUser.station?(i(),h(_,{key:1,style:{"margin-right":"10px"},type:"success"},{default:r(()=>[c(m(e.selectUser.station),1)]),_:1})):g("",!0),e.selectUser.grid?(i(),h(_,{key:2,type:"info"},{default:r(()=>[c(m(e.selectUser.grid),1)]),_:1})):g("",!0)]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["onOpen","onClosed","modelValue"])])}var R=$(E,[["render",G],["__scopeId","data-v-3c0e3f91"]]);export{R as A};
