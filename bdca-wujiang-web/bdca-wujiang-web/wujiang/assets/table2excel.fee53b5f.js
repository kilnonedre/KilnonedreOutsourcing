const E=()=>{let t=window.navigator.userAgent;if(t.indexOf("MSIE")>=0)return"ie";if(t.indexOf("Firefox")>=0)return"Firefox";if(t.indexOf("Chrome")>=0)return"Chrome";if(t.indexOf("Opera")>=0)return"Opera";if(t.indexOf("Safari")>=0)return"Safari"},k=(t,s)=>{E()=="ie"?v(t):y(t,s)},v=(t,s)=>{let d=t,l=new ActiveXObject("Excel.Application"),n=l.Workbooks.Add(),r=n.Worksheets(1),o=document.body.createTextRange();o.moveToElementText(d),o.select,o.execCommand("Copy"),r.Paste(),l.Visible=!0;try{let c=l.Application.GetSaveAsFilename("Excel.xls","Excel Spreadsheets (*.xls), *.xls")}catch(c){print("Nested catch caught "+c)}finally{n.SaveAs(fname),n.Close(savechanges=!1),l.Quit(),l=null,window.setInterval("Cleanup();",1),window.setInterval("Cleanup();",1)}},y=function(){const t="data:application/vnd.ms-excel;base64,",s='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta charset="UTF-8"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',d=function(n){return window.btoa(unescape(encodeURIComponent(n)))},l=(n,r)=>n.replace(/{(\w+)}/g,(o,c)=>r[c]);return(n,r)=>{const c=t+d(l(s,{worksheet:r,table:n}));if(navigator.userAgent.indexOf("Firefox")>-1)window.location.href=c;else{const x=document.createElement("a");x.href=c,x.download=r||"";let h;window.MouseEvent?h=new MouseEvent("click"):(h=document.createEvent("MouseEvents"),h.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null)),x.dispatchEvent(h)}}}(),$=(t,s,d)=>{const l={image:h,text:x};let n="",r=t.reduce((i,e)=>{if(i+=`<th rowspan=${e.children&&e.children.length?1:2} colspan=${e.children&&e.children.length?e.children.length:1}>${e.title}</th>`,e.children&&e.children.length)for(let f=0;f<e.children.length;f++)n+=`<th>${e.children[f].title}</th>`;return i},"");r=`<thead><tr>${r}</tr><tr>${n}</tr></thead>`;let o=s.reduce((i,e)=>(i+=`<tr>${t.reduce((g,a)=>{var p;let u="";return a.children&&a.children.length>0?u=a.children.reduce((m,w)=>{var b;return m+=l[w.type||"text"]((b=e[a.title][w.key])!=null?b:"",m),m},""):u+=l[a.type||"text"]((p=e[a.key])!=null?p:"",a),g+=u,g},"")}</tr>`,i),"");o=`<tbody>${o}</tbody>`;const c=r+o;k(c,d);function x(i){return`<td style="text-align: center;vnd.ms-excel.numberformat:@">${i}</td>`}function h(i,e){return e=Object.assign({width:40,height:60},e),`<td style="width: ${e.width}px; height: ${e.height}px; text-align: center; vertical-align: middle"><img src="${i}" width=${e.width} height=${e.height}></td>`}};export{$ as t};
