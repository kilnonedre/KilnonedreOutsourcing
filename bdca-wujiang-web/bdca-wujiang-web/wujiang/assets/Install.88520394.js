import{C as Y}from"./CommonHeader.a228caf3.js";import{d as W}from"./api.22883e35.js";import{_ as A,C,a as E,r as u,k as M,o as i,c,d as r,b as n,w as h,T as P,m as D,i as m,F as f,h as b,f as k,D as F,p as B,q,t as v}from"./index.22501be6.js";import{t as G}from"./table2excel.fee53b5f.js";import{_ as K}from"./icon_screen.7fe101fd.js";const w={woNbr:{label:"\u5DE5\u5355\u53F7",width:"120"},businessName:{label:"\u5B89\u88C5\u7C7B\u578B",width:"200"},custId:{label:"\u5BA2\u6237\u8BC1\u53F7",width:"160"},custName:{label:"\u5BA2\u6237\u59D3\u540D",width:"120"},contactInfo:{label:"\u8054\u7CFB\u4FE1\u606F",width:"400"},situated:{label:"\u5730\u5740",width:"450"},station:{label:"\u4E2D\u5FC3\u53CA\u5E7F\u7535\u7AD9",width:"180"},gridName:{label:"\u7F51\u683C\u540D\u79F0",width:"180"},exchId:{label:"\u7F51\u683CID",width:"180"},runSts:{label:"\u5DE5\u5355\u72B6\u6001",width:"120"},soStaffName:{label:"\u53D7\u7406\u4EBA",width:"120"},executeStaffName:{label:"\u65BD\u5DE5\u5458",width:"120"},createDate:{label:"\u5DE5\u5355\u751F\u4EA7\u65F6\u95F4",width:"160"},asgnDate:{label:"\u6D3E\u5355\u65F6\u95F4",width:"160"},completeDate:{label:"\u5B8C\u6210\u65F6\u95F4",width:"200"},bookTime:{label:"\u9884\u7EA6\u65F6\u95F4",width:"180"},remarks:{label:"\u5907\u6CE8",width:"250"},surveyStaffName:{label:"\u56DE\u8BBF\u5458",width:"120"},stsWords:{label:"\u56DE\u8BBF\u7ED3\u679C",width:"200"},dissatisfiedReason:{label:"\u4E0D\u6EE1\u610F\u539F\u56E0",width:"200"},mainProd:{label:"\u4E3B\u673A\u6807\u8BC6",width:"120"},accessWay:{label:"\u63A5\u5165\u65B9\u5F0F",width:"200"},handleTypeName:{label:"\u64CD\u4F5C\u7C7B\u578B",width:"200"},isovertime:{label:"\u662F\u5426\u8D85\u65F6",width:"120"},completeMin:{label:"\u5B8C\u6210\u65F6\u957F(\u5206\u949F)",width:"160"},orderRank:{label:"\u5BA2\u6237\u6309\u6708\u5DE5\u5355\u6392\u5E8F",width:"200"}},Q={components:{CommonHeader:Y},data(){return{date:"",station:"",gridName:"",station_grid:[],stationOptions:[],userInfo:{},businessName:[],businessList:[],runSts:"",runStsList:["C","D","P"],executeStaffName:"",staffList:[],stsWords:"",stsWordsList:[],dissatisfiedReason:"",dissatisfiedReasonList:[],accessWay:[],accessWayList:[],isovertime:"",isovertimeList:["\u662F","\u5426"],complete1:void 0,complete2:void 0,downLoading:!1,loading:!1,showScreen:!1,checkAll:!0,checkedHeaders:[],showHeader:[],allHeader:w,tableHeader:{},tableData:[],ascs:"",descs:"",currentPage:1,total:1,pageSize:100}},methods:{async initList(){await W.getInstalled({size:-1}).then(s=>{s.records.forEach(e=>{e.businessName!=null&&this.businessList.indexOf(e.businessName)==-1&&this.businessList.push(e.businessName),window.localStorage.setItem("businessListForInstall",JSON.stringify(this.businessList)),e.executeStaffName!=null&&this.staffList.indexOf(e.executeStaffName)==-1&&this.staffList.push(e.executeStaffName),window.localStorage.setItem("staffList",JSON.stringify(this.staffList)),e.stsWords!=null&&this.stsWordsList.indexOf(e.stsWords)==-1&&this.stsWordsList.push(e.stsWords),window.localStorage.setItem("stsWordsList",JSON.stringify(this.stsWordsList)),e.dissatisfiedReason!=null&&this.dissatisfiedReasonList.indexOf(e.dissatisfiedReason)==-1&&this.dissatisfiedReasonList.push(e.dissatisfiedReason),window.localStorage.setItem("dissatisfiedReasonList",JSON.stringify(this.dissatisfiedReasonList)),e.accessWay!=null&&this.accessWayList.indexOf(e.accessWay)==-1&&this.accessWayList.push(e.accessWay),window.localStorage.setItem("accessWayList",JSON.stringify(this.accessWayList))})})},getTableList(){this.loading=!0,this.tableData=[],W.getInstalled({size:this.pageSize,current:this.currentPage,date1:C(this.date)?this.date[0]:"",date2:C(this.date)?this.date[1]:"",station:this.station,gridName:this.gridName,businessNameSet:this.businessName.join(),runSts:this.runSts,executeStaffName:this.executeStaffName,stsWords:this.stsWords,dissatisfiedReason:this.dissatisfiedReason,accessWaySet:this.accessWay.join(),isovertime:this.isovertime,complete1:this.complete1,complete2:this.complete2,descs:this.descs,ascs:this.ascs}).then(s=>{this.tableData=s.records,this.total=s.total}).finally(()=>{this.loading=!1,this.$nextTick(()=>{this.$refs.install.doLayout()})})},changeTime(){this.getTableList()},changeStation(s){this.station=s?s[0]:"",this.gridName=s&&s.length>1?s[1]:"",this.getTableList()},getDay(s,e){var o=new Date,g=o.getTime(),l=24*3600*1e3*s;o.setTime(parseInt(g+l));var a=o.getFullYear(),S=(o.getMonth()+1).toString();S.length<=1&&(S="0"+S);var L=o.getDate().toString();return L.length<=1&&(L="0"+L),a+e+S+e+L},inputNumber(s,e){const o=/^(\-|\+)?\d+(\.\d+)?$/;s==""||s==null||o.test(s)?(e=="left"?this.complete1=s:this.complete2=s,this.getTableList()):(e=="left"?this.complete1=void 0:this.complete2=void 0,this.$message.error("\u8BF7\u8F93\u5165\u6570\u5B57\uFF01"),this.getTableList())},handleSizeChange(s){this.pageSize=s,this.currentPage=1,this.getTableList()},handleCurrentChange(s){this.currentPage=s,this.getTableList()},sortTable({prop:s,order:e}){e=="ascending"?(this.ascs=s,this.descs=""):e=="descending"?(this.ascs="",this.descs=s):(this.ascs="",this.descs=""),this.getTableList()},onExport(){let s=[];this.downLoading=!0,W.getInstalled({size:-1,date1:C(this.date)?this.date[0]:"",date2:C(this.date)?this.date[1]:"",station:this.station,gridName:this.gridName,businessNameSet:this.businessName.join(),runSts:this.runSts,executeStaffName:this.executeStaffName,stsWords:this.stsWords,dissatisfiedReason:this.dissatisfiedReason,accessWaySet:this.accessWay.join(),isovertime:this.isovertime,complete1:this.complete1,complete2:this.complete2,descs:this.descs,ascs:this.ascs}).then(e=>{s=e.records,e.records.forEach(a=>{a.createDate=a.createDate?a.createDate.split(" ")[0]:"-",a.asgnDate=a.asgnDate?a.asgnDate.split(" ")[0]:"-",a.completeDate=a.completeDate?a.completeDate.split(" ")[0]:"-",a.bookTime=a.bookTime?a.bookTime.split(" ")[0]:"-"});let o=[],g;for(let a in this.tableHeader)g={title:this.tableHeader[a].label,key:a,type:"text"},o.push(g);G(o,s,"\u5B89\u88C5\u5DE5\u5355\u660E\u7EC6")}).finally(()=>{this.downLoading=!1})},clickScreen(){this.showScreen=!0},handleCheckAllChange(s){this.checkedHeaders=s?this.computeCheckedHeaders(w):[],this.showHeader=s?w:[]},computeCheckedHeaders(s){let e=[];for(let o in s)e.push(o);return this.checkedHeaders=e,e},handleCheckedHeaderChange(s){let e=s.length;this.checkAll=e===Object.keys(w).length;let o={};s.forEach(g=>{o[g]=this.allHeader[g]}),this.showHeader=o},confirm(){this.tableHeader=this.showHeader,window.localStorage.setItem("install",JSON.stringify(this.tableHeader)),this.showScreen=!1,this.$nextTick(()=>{this.$refs.install.doLayout()})},cancel(){this.showHeader=this.tableHeader,this.showScreen=!1,this.checkAll=Object.keys(this.tableHeader).length===Object.keys(this.computeCheckedHeaders(this.tableHeader)).length}},created(){this.date=[this.getDay(-1,"/"),this.getDay(-1,"/")];let s=window.localStorage.getItem("install");this.showHeader=s?JSON.parse(s):w,this.tableHeader=s?JSON.parse(s):w,this.computeCheckedHeaders(this.tableHeader),this.checkAll=Object.keys(this.showHeader).length===Object.keys(w).length,this.tableHeader=w,this.userInfo=JSON.parse(E.get("user"));let e=[],o=this.userInfo.grid?this.userInfo.grid.split(","):[];e.push({value:this.userInfo.station,label:this.userInfo.station,children:[]}),o.forEach(g=>{e[0].children.push({value:g,label:g})}),this.stationOptions=this.userInfo.grade=="\u7BA1\u7406\u5458"?window.config.stationOptions:e,this.station_grid=[this.userInfo.station],o.length&&this.station_grid.push(o[0]),this.station=this.userInfo.station,this.gridName=o[0],s=window.localStorage.getItem("businessListForInstall"),this.businessList=s?JSON.parse(s):[],s=window.localStorage.getItem("staffList"),this.staffList=s?JSON.parse(s):[],s=window.localStorage.getItem("stsWordsList"),this.stsWordsList=s?JSON.parse(s):[],s=window.localStorage.getItem("dissatisfiedReasonList"),this.dissatisfiedReasonList=s?JSON.parse(s):[],s=window.localStorage.getItem("accessWayList"),this.accessWayList=s?JSON.parse(s):[],(this.businessList.length==0||this.staffList.length==0||this.stsWordsList.length==0||this.dissatisfiedReasonList.length==0||this.accessWayList.length==0)&&this.initList(),this.getTableList()}},N=s=>(B("data-v-3f30d91e"),s=s(),q(),s),X={class:"page order"},Z={class:"content"},j={class:"tab-content"},$={class:"toolbox"},ee={class:"left"},te={class:"level"},se={class:"level"},le={class:"search-range"},ae=N(()=>n("span",{style:{"font-size":"15px",width:"130px"}},"\u5B89\u88C5\u65F6\u957F\uFF08\u5206\u949F\uFF09:",-1)),ie=N(()=>n("span",{style:{margin:"0 10px"}},"~",-1)),ne={class:"right"},oe={class:"table"},re={class:"screen-wrap"},de=N(()=>n("div",{style:{margin:"15px 0"}},null,-1)),he={key:0},ce={key:1},ue={key:2},ge={key:3},pe={key:4,style:{"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},me=N(()=>n("div",{style:{"margin-top":"5%"}},"\u6682\u65E0\u6570\u636E",-1)),fe={class:"pagination"};function be(s,e,o,g,l,a){const S=u("common-header"),L=u("el-date-picker"),H=u("el-cascader"),_=u("el-option"),y=u("el-select"),x=u("el-input-number"),V=u("el-button"),T=u("el-tooltip"),I=u("el-checkbox"),O=u("el-checkbox-group"),z=u("el-table-column"),R=u("el-table"),J=u("el-pagination"),U=M("loading");return i(),c("div",X,[r(S,{title:"\u5B89\u88C5\u5DE5\u5355\u660E\u7EC6"}),n("div",Z,[n("div",j,[n("div",$,[n("div",ee,[n("div",te,[n("div",null,[r(L,{modelValue:l.date,"onUpdate:modelValue":e[0]||(e[0]=t=>l.date=t),type:"daterange",format:"YYYY-MM-DD","value-format":"YYYY/MM/DD","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F",style:{width:"250px"},onChange:a.changeTime},null,8,["modelValue","onChange"])]),n("div",null,[r(H,{modelValue:l.station_grid,"onUpdate:modelValue":e[1]||(e[1]=t=>l.station_grid=t),style:{width:"250px"},options:l.stationOptions,props:{checkStrictly:l.userInfo.grade!="\u7F51\u683C\u5458"},onChange:a.changeStation,placeholder:"\u4E2D\u5FC3\u53CA\u5E7F\u7535\u7AD9",clearable:l.userInfo.grade=="\u7BA1\u7406\u5458",filterable:""},null,8,["modelValue","options","props","onChange","clearable"])]),n("div",null,[r(y,{modelValue:l.businessName,"onUpdate:modelValue":e[2]||(e[2]=t=>l.businessName=t),placeholder:"\u5B89\u88C5\u7C7B\u578B",multiple:"","collapse-tags":"","collapse-tags-tooltip":"",filterable:"",clearable:"",onChange:a.getTableList},{default:h(()=>[(i(!0),c(f,null,b(l.businessList,t=>(i(),m(_,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),n("div",null,[r(y,{modelValue:l.runSts,"onUpdate:modelValue":e[3]||(e[3]=t=>l.runSts=t),placeholder:"\u5DE5\u5355\u72B6\u6001",filterable:"",clearable:"",onChange:a.getTableList},{default:h(()=>[(i(!0),c(f,null,b(l.runStsList,t=>(i(),m(_,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),n("div",null,[r(y,{modelValue:l.executeStaffName,"onUpdate:modelValue":e[4]||(e[4]=t=>l.executeStaffName=t),placeholder:"\u65BD\u5DE5\u5458",filterable:"",clearable:"",onChange:a.getTableList},{default:h(()=>[(i(!0),c(f,null,b(l.staffList,t=>(i(),m(_,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])])]),n("div",se,[n("div",null,[r(y,{modelValue:l.stsWords,"onUpdate:modelValue":e[5]||(e[5]=t=>l.stsWords=t),placeholder:"\u7535\u8BDD\u56DE\u8BBF\u7ED3\u679C",filterable:"",clearable:"",onChange:a.getTableList},{default:h(()=>[(i(!0),c(f,null,b(l.stsWordsList,t=>(i(),m(_,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),n("div",null,[r(y,{modelValue:l.dissatisfiedReason,"onUpdate:modelValue":e[6]||(e[6]=t=>l.dissatisfiedReason=t),placeholder:"\u4E0D\u6EE1\u610F\u539F\u56E0",filterable:"",clearable:"",onChange:a.getTableList},{default:h(()=>[(i(!0),c(f,null,b(l.dissatisfiedReasonList,t=>(i(),m(_,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),n("div",null,[r(y,{modelValue:l.accessWay,"onUpdate:modelValue":e[7]||(e[7]=t=>l.accessWay=t),placeholder:"\u63A5\u5165\u65B9\u5F0F",multiple:"","collapse-tags":"","collapse-tags-tooltip":"",filterable:"",clearable:"",onChange:a.getTableList},{default:h(()=>[(i(!0),c(f,null,b(l.accessWayList,t=>(i(),m(_,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),n("div",null,[r(y,{modelValue:l.isovertime,"onUpdate:modelValue":e[8]||(e[8]=t=>l.isovertime=t),placeholder:"\u662F\u5426\u8D85\u65F6",clearable:"",onChange:a.getTableList},{default:h(()=>[(i(!0),c(f,null,b(l.isovertimeList,t=>(i(),m(_,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),n("div",le,[ae,r(x,{style:{width:"150px"},modelValue:l.complete1,"onUpdate:modelValue":e[9]||(e[9]=t=>l.complete1=t),min:0,precision:0,placeholder:"\u6700\u5C0F\u503C",onChange:e[10]||(e[10]=t=>a.inputNumber(t,"left"))},null,8,["modelValue"]),ie,r(x,{style:{width:"150px"},min:0,precision:0,modelValue:l.complete2,"onUpdate:modelValue":e[11]||(e[11]=t=>l.complete2=t),placeholder:"\u6700\u5927\u503C",onChange:e[12]||(e[12]=t=>a.inputNumber(t,"right"))},null,8,["modelValue"])])])]),n("div",ne,[r(V,{type:"primary",onClick:a.onExport,loading:l.downLoading},{default:h(()=>[k(" \u5BFC\u51FA\u6570\u636E ")]),_:1},8,["onClick","loading"])])]),n("div",oe,[r(T,{effect:"dark",content:"\u7B5B\u9009\u8868\u683C\u5217",placement:"top"},{default:h(()=>[n("img",{onClick:e[13]||(e[13]=(...t)=>a.clickScreen&&a.clickScreen(...t)),class:"icon-screen",src:K,alt:""})]),_:1}),r(P,{name:"el-zoom-in-top"},{default:h(()=>[D(n("div",re,[r(I,{modelValue:l.checkAll,"onUpdate:modelValue":e[14]||(e[14]=t=>l.checkAll=t),onChange:a.handleCheckAllChange},{default:h(()=>[k("\u5168\u9009")]),_:1},8,["modelValue","onChange"]),de,r(O,{modelValue:l.checkedHeaders,"onUpdate:modelValue":e[15]||(e[15]=t=>l.checkedHeaders=t),onChange:a.handleCheckedHeaderChange},{default:h(()=>[(i(!0),c(f,null,b(l.allHeader,(t,d)=>(i(),m(I,{label:d,key:d},{default:h(()=>[k(v(t.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","onChange"]),r(V,{onClick:a.cancel,style:{"margin-top":"20px","margin-right":"20px"},size:"small"},{default:h(()=>[k("\u53D6\u6D88 ")]),_:1},8,["onClick"]),r(V,{onClick:a.confirm,style:{"margin-top":"20px","margin-right":"20px"},type:"primary",size:"small"},{default:h(()=>[k("\u786E\u5B9A ")]),_:1},8,["onClick"])],512),[[F,l.showScreen]])]),_:1}),D((i(),m(R,{ref:"install",height:"100%",stripe:"",border:"",data:l.tableData,"header-cell-style":{background:"#eaf2fe",color:"#383838",fontSize:"16px",height:"34px"},"row-style":{height:"24px",fontSize:"14px"},onSortChange:a.sortTable},{empty:h(()=>[me]),default:h(()=>[(i(!0),c(f,null,b(l.tableHeader,(t,d)=>(i(),m(z,{label:t.label,prop:d,align:"center","min-width":t.width?t.width+"":"100",sortable:"custom"},{default:h(p=>[d==="createDate"?(i(),c("span",he,v(p.row[d]?p.row[d].split(" ")[0]:"-"),1)):d==="asgnDate"?(i(),c("span",ce,v(p.row[d]?p.row[d].split(" ")[0]:"-"),1)):d==="completeDate"?(i(),c("span",ue,v(p.row[d]?p.row[d].split(" ")[0]:"-"),1)):d==="bookTime"?(i(),c("span",ge,v(p.row[d]?p.row[d].split(" ")[0]:"-"),1)):(i(),c("span",pe,v(p.row[d]?p.row[d]:"-"),1))]),_:2},1032,["label","prop","min-width"]))),256))]),_:1},8,["data","onSortChange"])),[[U,l.loading]])]),n("div",fe,[r(J,{"current-page":l.currentPage,"page-size":l.pageSize,"page-sizes":[20,30,50,100],total:l.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:a.handleSizeChange,onCurrentChange:a.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])])])}var ve=A(Q,[["render",be],["__scopeId","data-v-3f30d91e"]]);export{ve as default};
