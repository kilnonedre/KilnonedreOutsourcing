import{u as b}from"./api.22883e35.js";import{s as k,o as V,i as z,d as o,_ as E,a as m,r as l,c as P,b as p,w as r,f as n,t as c}from"./index.22501be6.js";var f=k({name:"ArrowDown"});const U={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},N=o("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"},null,-1);function T(a,s,i,d,e,u){return V(),z("svg",U,[N])}f.render=T;f.__file="packages/components/ArrowDown.vue";var W=f;const Z={props:["title"],components:{ArrowDown:W},data(){return{username:"",dialogVisible:!1,ruleForm:{password:"",newpassword:"",confirmpassword:""},rules:{password:[{required:!0,message:"\u8BF7\u8F93\u5165\u539F\u6765\u7684\u5BC6\u7801",trigger:"blur"}],newpassword:[{required:!0,validator:(i,d,e)=>{d===""?e(new Error("\u8BF7\u8F93\u5165\u65B0\u5BC6\u7801")):/^(?![a-zA-Z]+$)(?![A-Z0-9]+$)(?![A-Z\W_]+$)(?![a-z0-9]+$)(?![a-z\W_]+$)(?![0-9\W_]+$)[a-zA-Z0-9\W_]{8,}$/.test(d)==!1?e(new Error("\u5BC6\u7801\u9700\u5305\u542B\u5927\u5C0F\u5199\u5B57\u6BCD\u3001\u6570\u5B57\u3001\u7279\u6B8A\u5B57\u7B26\u81F3\u5C11\u4E09\u79CD\uFF0C\u81F3\u5C118\u4F4D")):(this.ruleForm.confirmpassword!==""&&this.$refs.ruleForm.validateField("confirmpassword"),e())},trigger:"blur"}],confirmpassword:[{required:!0,validator:(i,d,e)=>{d===""?e(new Error("\u8BF7\u518D\u6B21\u8F93\u5165\u65B0\u5BC6\u7801")):d!==this.ruleForm.newpassword?e(new Error("\u4E24\u6B21\u8F93\u5165\u7684\u5BC6\u7801\u4E0D\u4E00\u81F4!")):e()},trigger:"blur"}]}}},mounted(){m.get("user")&&(this.username=JSON.parse(m.get("user")).usernick)},methods:{handleDropdown(a){switch(a){case"pwd":this.dialogVisible=!0;break;case"logout":this.$confirm("\u60A8\u786E\u5B9A\u9000\u51FA\u767B\u5F55?","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{b.logout().then(()=>{}).finally(()=>{m.remove("user"),this.$router.push("/login")})});break}},handleConfirm(a){this.$refs[a].validate(s=>{if(s)b.editPassword({password:this.ruleForm.password,newpassword:this.ruleForm.confirmpassword}).then(()=>{this.$message.success("\u4FEE\u6539\u6210\u529F\uFF01"),setTimeout(()=>{m.remove("user"),this.$router.push("/login")},2e3)});else return!1})}}},q={class:"header"},H={class:"left"},S={class:"right"},J={class:"el-dropdown-link"},L={class:"dialog-footer"};function M(a,s,i,d,e,u){const g=l("el-breadcrumb-item"),F=l("el-breadcrumb"),C=l("el-avatar"),x=l("ArrowDown"),$=l("el-icon"),h=l("el-dropdown-item"),A=l("el-dropdown-menu"),y=l("el-dropdown"),_=l("el-input"),w=l("el-form-item"),D=l("el-form"),v=l("el-button"),B=l("el-dialog");return V(),P("div",q,[p("div",H,[o(F,null,{default:r(()=>[o(g,null,{default:r(()=>[n(c(a.$route.meta.parent),1)]),_:1}),o(g,null,{default:r(()=>[n(c(i.title),1)]),_:1})]),_:1})]),p("div",S,[o(y,{onCommand:u.handleDropdown},{dropdown:r(()=>[o(A,null,{default:r(()=>[o(h,{command:"pwd"},{default:r(()=>[n("\u4FEE\u6539\u5BC6\u7801")]),_:1}),o(h,{command:"logout"},{default:r(()=>[n("\u9000\u51FA\u767B\u5F55")]),_:1})]),_:1})]),default:r(()=>[p("span",J,[o(C,{size:"small"},{default:r(()=>[n(" U ")]),_:1}),n(c(e.username),1),o($,null,{default:r(()=>[o(x)]),_:1})])]),_:1},8,["onCommand"])]),o(B,{modelValue:e.dialogVisible,"onUpdate:modelValue":s[5]||(s[5]=t=>e.dialogVisible=t),title:"\u4FEE\u6539\u5BC6\u7801",width:"30%"},{footer:r(()=>[p("span",L,[o(v,{onClick:s[3]||(s[3]=t=>e.dialogVisible=!1)},{default:r(()=>[n("\u53D6\u6D88")]),_:1}),o(v,{type:"primary",onClick:s[4]||(s[4]=t=>u.handleConfirm("ruleForm"))},{default:r(()=>[n("\u786E\u5B9A")]),_:1})])]),default:r(()=>[o(D,{ref:"ruleForm",model:e.ruleForm,rules:e.rules,"label-width":"100px",class:"demo-dynamic","label-position":"left"},{default:r(()=>[o(w,{prop:"password",label:"\u65E7\u5BC6\u7801"},{default:r(()=>[o(_,{modelValue:e.ruleForm.password,"onUpdate:modelValue":s[0]||(s[0]=t=>e.ruleForm.password=t),autocomplete:"false","show-password":""},null,8,["modelValue"])]),_:1}),o(w,{prop:"newpassword",label:"\u65B0\u5BC6\u7801"},{default:r(()=>[o(_,{modelValue:e.ruleForm.newpassword,"onUpdate:modelValue":s[1]||(s[1]=t=>e.ruleForm.newpassword=t),autocomplete:"false","show-password":""},null,8,["modelValue"])]),_:1}),o(w,{prop:"confirmpassword",label:"\u786E\u8BA4\u5BC6\u7801"},{default:r(()=>[o(_,{modelValue:e.ruleForm.confirmpassword,"onUpdate:modelValue":s[2]||(s[2]=t=>e.ruleForm.confirmpassword=t),autocomplete:"false","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}var G=E(Z,[["render",M]]);export{G as C};
